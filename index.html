<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>My Street View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
    .popup-img {
      width: 200px;
      display: block;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Leaflet.js -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- 電柱番号解析・座標変換（誤差ゼロモデル） -->
  <script src="script.js"></script>

  <!-- 画像ファイル名一覧（手動列挙） -->
  <script src="filenames.js"></script>


  <script>
    // 地図の初期化（北海道中心）
    const map = L.map("map").setView([42.9, 142.7], 12);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "© OpenStreetMap contributors",
    }).addTo(map);

    // 電柱画像ファイル名から座標を計算してマーカー表示
    const locations = filenames.map((filename) => {
      const denchu = filename.replace(".jpg", "");
      const { lat, lng } = getLatLon(denchu);
      return { lat, lng, image: `images/${filename}`, id: denchu };
    });

    locations.forEach(({ lat, lng, image, id }) => {
      const popupContent = `
        <img src="${image}" class="popup-img" />
        <strong>${id}</strong><br />
        <a href="viewer.html?image=${id}.jpg" target="_blank">360度ビューを見る</a>
      `;
      L.marker([lat, lng]).addTo(map).bindPopup(popupContent);
    });
  </script>
</body>
</html>



